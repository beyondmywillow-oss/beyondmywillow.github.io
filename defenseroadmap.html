<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Defense Roadmap</title>
    
    <!-- Tailwind CSS (인터넷 필요) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />

    <style>
        body { font-family: 'Pretendard', sans-serif; -webkit-tap-highlight-color: transparent; }
        /* 모바일 터치감 개선 */
        button:active { transform: scale(0.98); }
    </style>
</head>
<body class="bg-gray-50 text-slate-800 pb-20 select-none">

    <div class="min-h-screen p-4 md:p-8">
        <div class="max-w-3xl mx-auto space-y-6">
            
            <!-- Header -->
            <header class="bg-slate-900 rounded-3xl shadow-xl p-6 text-white relative overflow-hidden">
                <div class="absolute -top-10 -right-10 w-40 h-40 bg-violet-500 rounded-full blur-3xl opacity-20"></div>
                <div class="absolute bottom-0 left-0 w-32 h-32 bg-lime-400 rounded-full blur-3xl opacity-10"></div>

                <div class="relative z-10 flex flex-row justify-between items-center gap-4">
                    <div>
                        <h1 class="text-2xl font-extrabold mb-1 tracking-tight">Defense Roadmap</h1>
                        <p class="text-slate-300 flex items-center gap-1 text-xs font-medium">
                            11.21 ~ 12.17 완주 프로젝트
                        </p>
                    </div>
                    <div class="flex flex-col items-end shrink-0">
                        <div id="d-day-badge" class="bg-lime-400 px-4 py-1.5 rounded-full text-slate-900 font-black text-lg shadow-lg">
                            D-Day
                        </div>
                    </div>
                </div>

                <div class="mt-6 relative z-10">
                    <div class="flex justify-between text-xs font-bold mb-2 text-lime-400 tracking-widest uppercase">
                        <span>Progress</span>
                        <span id="progress-text">0%</span>
                    </div>
                    <div class="w-full bg-slate-800 rounded-full h-2 overflow-hidden">
                        <div id="progress-bar" class="bg-lime-400 h-2 rounded-full shadow-[0_0_10px_rgba(163,230,53,0.5)] transition-all duration-700 ease-out" style="width: 0%"></div>
                    </div>
                </div>
            </header>

            <!-- Dashboard (Mobile Optimized) -->
            <div class="grid grid-cols-3 gap-3">
                <div class="bg-blue-50 p-3 rounded-2xl border border-blue-100 flex flex-col justify-between text-center">
                    <span class="text-[10px] font-bold text-blue-400 uppercase tracking-wider block mb-1">Goal</span>
                    <div>
                        <div class="text-lg font-bold text-slate-800 leading-tight">작성<br>완료</div>
                        <div class="text-[10px] font-medium text-blue-600 mt-1">12.10(수)</div>
                    </div>
                </div>
                <div class="bg-violet-50 p-3 rounded-2xl border border-violet-100 flex flex-col justify-between text-center">
                    <span class="text-[10px] font-bold text-violet-400 uppercase tracking-wider block mb-1">Submit</span>
                    <div>
                        <div class="text-lg font-bold text-slate-800 leading-tight">실적<br>제출</div>
                        <div class="text-[10px] font-medium text-violet-600 mt-1">12.12(금)</div>
                    </div>
                </div>
                <div class="bg-slate-900 p-3 rounded-2xl border border-slate-800 flex flex-col justify-between text-center shadow-lg">
                    <span class="text-[10px] font-bold text-slate-500 uppercase tracking-wider block mb-1">Defense</span>
                    <div>
                        <div class="text-lg font-bold text-white leading-tight">논문<br>심사</div>
                        <div class="text-[10px] font-medium text-lime-400 mt-1">12.17(수)</div>
                    </div>
                </div>
            </div>

            <!-- List Container -->
            <div id="schedule-list" class="space-y-4">
                <!-- Javascript가 여기에 리스트를 채워넣습니다 -->
            </div>

            <footer class="text-center py-8 space-y-4">
                <p class="text-slate-400 text-xs font-medium">
                    데이터는 사용하시는 기기에 자동 저장됩니다.
                </p>
                <button onclick="resetData()" class="text-xs text-slate-300 underline p-2">
                    데이터 초기화
                </button>
            </footer>
        </div>
    </div>

    <script>
        // --- Data & Logic (Vanila JS) ---
        const TODAY = new Date('2025-11-21T00:00:00');
        const DEFENSE_DATE = new Date('2025-12-17T00:00:00');

        const defaultSchedule = [
            {
                id: 1, phase: "실험 및 데이터 확정", dates: "11.21(금) - 11.22(토)",
                isTarget: false, isDeadline: false, isDday: false,
                tasks: [
                    { id: 't1-1', text: "실험 최종 마무리 및 데이터 수집 완료", completed: false },
                    { id: 't1-2', text: "Raw Data 백업 및 정리", completed: false }
                ]
            },
            {
                id: 2, phase: "결과 분석 (뼈대 잡기)", dates: "11.23(일) - 11.26(수)",
                isTarget: false, isDeadline: false, isDday: false,
                tasks: [
                    { id: 't2-1', text: "데이터 통계 분석 및 해석", completed: false },
                    { id: 't2-2', text: "[결과] 표(Table) 및 그림(Figure) 제작", completed: false },
                    { id: 't2-3', text: "논문 목차(Outline) 세부 확정", completed: false }
                ]
            },
            {
                id: 3, phase: "핵심 집필: 방법 & 결과", dates: "11.27(목) - 11.30(일)",
                isTarget: false, isDeadline: false, isDday: false,
                tasks: [
                    { id: 't3-1', text: "[연구 방법] 작성 (실험 설계 등)", completed: false },
                    { id: 't3-2', text: "[결과] 작성 (도표 해석 위주)", completed: false }
                ]
            },
            {
                id: 4, phase: "핵심 집필: 서론 & 이론", dates: "12.01(월) - 12.04(목)",
                isTarget: false, isDeadline: false, isDday: false,
                tasks: [
                    { id: 't4-1', text: "[이론적 배경] 선행 연구 정리", completed: false },
                    { id: 't4-2', text: "[서론] 연구 필요성 기술", completed: false }
                ]
            },
            {
                id: 5, phase: "심화 집필: 논의 & 초록", dates: "12.05(금) - 12.08(월)",
                isTarget: false, isDeadline: false, isDday: false,
                tasks: [
                    { id: 't5-1', text: "[논의] 결과 의의 및 제언 작성", completed: false },
                    { id: 't5-2', text: "국문/영문 초록(Abstract) 작성", completed: false },
                    { id: 't5-3', text: "참고문헌 서식 정리", completed: false }
                ]
            },
            {
                id: 6, phase: "최종 편집 (작성 완료)", dates: "12.09(화) - 12.10(수)",
                isTarget: true, isDeadline: false, isDday: false,
                tasks: [
                    { id: 't6-1', text: "전체 논리 검토 및 오타 수정", completed: false },
                    { id: 't6-2', text: "지도교수님 최종 확인 요청", completed: false },
                    { id: 't6-3', text: "★ 심사 1주 전 작성 완료", completed: false }
                ]
            },
            {
                id: 7, phase: "행정 처리 및 실적 제출", dates: "12.11(목) - 12.12(금)",
                isTarget: false, isDeadline: true, isDday: false,
                tasks: [
                    { id: 't7-1', text: "논문 가제본/파일 준비", completed: false },
                    { id: 't7-2', text: "★ 12일: 실적 제출 마감 준수", completed: false }
                ]
            },
            {
                id: 8, phase: "발표 자료 준비", dates: "12.13(토) - 12.16(화)",
                isTarget: false, isDeadline: false, isDday: false,
                tasks: [
                    { id: 't8-1', text: "심사 발표용 PPT 제작", completed: false },
                    { id: 't8-2', text: "발표 대본 작성 및 리허설", completed: false },
                    { id: 't8-3', text: "예상 질문 리스트업", completed: false }
                ]
            },
            {
                id: 9, phase: "D-Day: 논문 심사", dates: "12.17(수)",
                isTarget: false, isDeadline: false, isDday: true,
                tasks: [
                    { id: 't9-1', text: "최종 발표 및 질의응답", completed: false },
                    { id: 't9-2', text: "심사 후 수정사항 정리", completed: false }
                ]
            }
        ];

        let scheduleData = defaultSchedule;
        try {
            const saved = localStorage.getItem('defenseRoadmapData_Local');
            if (saved) scheduleData = JSON.parse(saved);
        } catch (e) { console.error(e); }

        document.addEventListener('DOMContentLoaded', () => {
            renderDday();
            renderList();
            updateProgress();
        });

        function renderDday() {
            const diffTime = DEFENSE_DATE - TODAY;
            const dDay = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            document.getElementById('d-day-badge').textContent = `D-${dDay}`;
        }

        function renderList() {
            const container = document.getElementById('schedule-list');
            container.innerHTML = '';

            scheduleData.forEach(phase => {
                let wrapperClass = "bg-white rounded-2xl p-5 shadow-sm border border-slate-100";
                let dateBadgeClass = "bg-slate-50 text-slate-500";
                let titleClass = "text-base font-bold text-slate-800";
                let checkColor = "text-lime-500";
                
                if (phase.isTarget) {
                    wrapperClass = "bg-blue-50/60 rounded-2xl p-5 border-2 border-blue-100 shadow-sm";
                    dateBadgeClass = "bg-white text-blue-600 font-bold shadow-sm";
                    titleClass = "text-base font-extrabold text-blue-900";
                    checkColor = "text-blue-500";
                } else if (phase.isDeadline) {
                    wrapperClass = "bg-violet-50/60 rounded-2xl p-5 border-2 border-violet-100 shadow-sm";
                    dateBadgeClass = "bg-white text-violet-600 font-bold shadow-sm";
                    titleClass = "text-base font-extrabold text-violet-900";
                    checkColor = "text-violet-500";
                } else if (phase.isDday) {
                    wrapperClass = "bg-slate-900 rounded-2xl p-5 shadow-xl border border-slate-800 relative overflow-hidden";
                    dateBadgeClass = "bg-slate-800 text-lime-400 font-bold border border-slate-700";
                    titleClass = "text-base font-extrabold text-white";
                    checkColor = "text-lime-400";
                }

                const month = phase.dates.split('.')[0];
                const day = phase.dates.split('(')[0].split('.')[1];
                
                let html = `
                    <div class="${wrapperClass}">
                        ${phase.isDday ? '<div class="absolute top-0 right-0 w-20 h-20 bg-gradient-to-bl from-lime-500/20 to-transparent rounded-bl-full pointer-events-none"></div>' : ''}
                        
                        <div class="flex flex-row items-center justify-between mb-4 gap-3 relative z-10">
                            <div class="flex items-center gap-3">
                                <div class="flex flex-col items-center justify-center w-12 h-12 rounded-xl shrink-0 text-xs leading-tight ${dateBadgeClass}">
                                    <span class="text-xs font-bold">${month}월</span>
                                    <span>${day}일</span>
                                </div>
                                <div>
                                    <h3 class="${titleClass}">${phase.phase}</h3>
                                    <p class="text-xs mt-0.5 font-medium ${phase.isDday ? 'text-slate-400' : 'text-slate-500'}">
                                        ${phase.dates}
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-2 relative z-10">
                `;

                phase.tasks.forEach(task => {
                    const checkIcon = task.completed 
                        ? `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fill-current"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>`
                        : `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/></svg>`;
                    
                    const textColor = task.completed 
                        ? (phase.isDday ? 'text-slate-500 line-through' : 'text-slate-400 line-through')
                        : (phase.isDday ? 'text-slate-200' : 'text-slate-700');
                    
                    const iconColor = task.completed ? checkColor : (phase.isDday ? 'text-slate-600' : 'text-slate-300');
                    const bgClass = phase.isDday ? 'bg-slate-800/50' : 'bg-slate-50/50';

                    html += `
                        <button onclick="toggleTask(${phase.id}, '${task.id}')" 
                                class="w-full flex items-start gap-3 p-2.5 rounded-lg text-left transition-all active:scale-[0.98] ${bgClass} ${phase.isDday && task.completed ? 'opacity-50' : ''}">
                            <div class="mt-0.5 shrink-0 transition-colors ${iconColor}">
                                ${checkIcon}
                            </div>
                            <span class="text-xs md:text-sm transition-all leading-relaxed font-medium ${textColor}">
                                ${task.text}
                            </span>
                        </button>
                    `;
                });

                html += `</div></div>`;
                container.innerHTML += html;
            });
        }

        function toggleTask(phaseId, taskId) {
            const phase = scheduleData.find(p => p.id === phaseId);
            if (phase) {
                const task = phase.tasks.find(t => t.id === taskId);
                if (task) {
                    task.completed = !task.completed;
                    saveData();
                    renderList();
                    updateProgress();
                }
            }
        }

        function updateProgress() {
            let total = 0;
            let completed = 0;
            scheduleData.forEach(phase => {
                phase.tasks.forEach(task => {
                    total++;
                    if (task.completed) completed++;
                });
            });
            const percentage = total === 0 ? 0 : Math.round((completed / total) * 100);
            document.getElementById('progress-text').textContent = `${percentage}%`;
            document.getElementById('progress-bar').style.width = `${percentage}%`;
        }

        function saveData() {
            localStorage.setItem('defenseRoadmapData_Local', JSON.stringify(scheduleData));
        }

        function resetData() {
            if (confirm("모든 기록을 초기화하시겠습니까?")) {
                localStorage.removeItem('defenseRoadmapData_Local');
                scheduleData = JSON.parse(JSON.stringify(defaultSchedule));
                renderList();
                updateProgress();
            }
        }
    </script>
</body>
</html>
